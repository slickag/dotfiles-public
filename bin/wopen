#!/usr/bin/env zsh
#
# # The same as double-clicking on file or dir $1 in Windows Explorer.

emulate zsh -o err_exit -o no_unset

if (( $# != 1 || $#1 == 0 )); then
  print -ru2 -- "usage: wopen FILE"
  exit 1
fi

local file
file=$(wslpath -wa -- "${1:A}")

cd /mnt/c
/mnt/c/Windows/System32/cmd.exe /c start "$file"
